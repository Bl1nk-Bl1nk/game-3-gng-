<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chaos Orb</title>
<style>
  body {
    margin: 0;
    background: black;
    overflow: hidden;
    font-family: monospace;
  }
  #ui {
    position: absolute;
    top: 10px;
    left: 10px;
    color: #00ffcc;
    font-size: 16px;
    z-index: 10;
  }
</style>
</head>
<body>

<canvas id="c"></canvas>
<div id="ui">TIME: 0</div>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let player = { x: canvas.width/2, y: canvas.height/2, r: 12 };
let keys = {};
let enemies = [];
let time = 0;
let chaos = 1;
let gameOver = false;

addEventListener("resize", ()=>{
  canvas.width = innerWidth;
  canvas.height = innerHeight;
});

addEventListener("keydown", e => keys[e.key] = true);
addEventListener("keyup", e => keys[e.key] = false);
addEventListener("click", ()=> gameOver && reset());

function reset(){
  enemies = [];
  time = 0;
  chaos = 1;
  gameOver = false;
  player.x = canvas.width/2;
  player.y = canvas.height/2;
}

function spawnEnemy(){
  const edge = Math.floor(Math.random()*4);
  let x,y,vx,vy;
  if(edge===0){x=0;y=Math.random()*canvas.height;vx=1;vy=0;}
  if(edge===1){x=canvas.width;y=Math.random()*canvas.height;vx=-1;vy=0;}
  if(edge===2){x=Math.random()*canvas.width;y=0;vx=0;vy=1;}
  if(edge===3){x=Math.random()*canvas.width;y=canvas.height;vx=0;vy=-1;}
  enemies.push({
    x,y,
    r: Math.random()*15+5,
    vx: vx*(Math.random()*2+chaos),
    vy: vy*(Math.random()*2+chaos)
  });
}

function update(){
  if(gameOver) return;

  ctx.fillStyle = `rgba(${Math.random()*40},0,40,0.25)`;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // random control swap
  let dx = (keys["a"]||keys["ArrowLeft"] ? -1 : 0) +
           (keys["d"]||keys["ArrowRight"] ? 1 : 0);
  let dy = (keys["w"]||keys["ArrowUp"] ? -1 : 0) +
           (keys["s"]||keys["ArrowDown"] ? 1 : 0);

  if(Math.random()<0.005) [dx,dy] = [dy,dx];

  player.x += dx * 4;
  player.y += dy * 4;

  player.x = Math.max(0,Math.min(canvas.width,player.x));
  player.y = Math.max(0,Math.min(canvas.height,player.y));

  ctx.beginPath();
  ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
  ctx.fillStyle="#00ffcc";
  ctx.fill();

  enemies.forEach(e=>{
    e.x+=e.vx;
    e.y+=e.vy;

    ctx.beginPath();
    ctx.arc(e.x,e.y,e.r,0,Math.PI*2);
    ctx.fillStyle=`hsl(${Math.random()*360},100%,60%)`;
    ctx.fill();

    const dist = Math.hypot(player.x-e.x, player.y-e.y);
    if(dist < player.r + e.r) gameOver = true;
  });

  if(Math.random() < 0.03) spawnEnemy();

  time++;
  chaos += 0.0005;
  document.getElementById("ui").innerText = "TIME: " + time;

  if(gameOver){
    ctx.fillStyle="rgba(0,0,0,0.7)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="white";
    ctx.font="30px monospace";
    ctx.fillText("CHAOS WINS", canvas.width/2-90, canvas.height/2);
    ctx.font="14px monospace";
    ctx.fillText("Click to restart", canvas.width/2-70, canvas.height/2+30);
  }

  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>
